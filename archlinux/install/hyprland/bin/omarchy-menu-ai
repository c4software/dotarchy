#!/bin/bash

menu() {
  local prompt="$1"
  local options="$2"
  local extra="$3"
  local preselect="$4"
  
  local options_count=$(echo -e "$options" | wc -l)
  if (( options_count > 10 )); then
    options_count=10
  fi

  read -r -a args <<<"$extra"

  if [[ -n "$preselect" ]]; then
    local index
    index=$(echo -e "$options" | grep -nxF "$preselect" | cut -d: -f1)
    if [[ -n "$index" ]]; then
      args+=("-a" "$index")
    fi
  fi

  echo -e "$options" | rofi -i -dmenu -theme-str "window { width: 250px; padding: 10px; } listview { lines: $options_count; }" "${args[@]}"
}

launch_or_focus_and_pin() {
  omarchy-launch-or-focus-webapp "$1" "$2"
}

case $(menu "LLM" "󱚤  ChatGPT\n󱚤  Gemini\n󱚤  Claude\n󱚤  LeChat\n󱚤  Grok\n󱚤  Meta") in
*ChatGPT*) launch_or_focus_and_pin "ChatGPT" "https://chat.openai.com/" ;;
*Gemini*) launch_or_focus_and_pin "Gemini" "https://gemini.google.com/" ;;
*Claude*) launch_or_focus_and_pin "Claude" "https://claude.ai/" ;;
*LeChat*) launch_or_focus_and_pin "LeChat" "https://chat.mistral.ai/chat" ;;
*Grok*) launch_or_focus_and_pin "Grok" "https://grok.com/" ;;
*Meta*) launch_or_focus_and_pin "Meta" "https://ai.meta.com/" ;;
*) exit ;;
esac